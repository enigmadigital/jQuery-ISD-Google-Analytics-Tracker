/*
* Izilla Search and Display jQuery Google Analytics Tracker v1.0
* Allows cross domain, file and external link tracking
*
* Copyright (c) 2012 Izilla Partners Pty Ltd
*
* http://www.izilla.com.au
* http://www.searchanddisplay.com.au
*
* Licensed under the MIT license
*/
;(function(a){a.fn.isdAnalyticsTracker=function(c){var y=a.extend({trackCrossDomain:false,domains:"",trackAlternatePropertyIDs:false,alternatePropertyIDs:["isd2"],trackFiles:true,trackFilesAsEvent:false,appendFiles:true,defaultFiles:[".csv",".doc",".pdf",".ppt",".rar",".rtf",".txt",".xls",".zip"],files:"",eventCategory:"External",delay:200},c);var r=window.location.host,q=y.domains,q=[].concat(q),w=y.alternatePropertyIDs.toString().replace(/\s/g,""),w=w.split(","),j=y.appendFiles?y.defaultFiles.concat(y.files):y.files,A=false,n=y.trackFilesAsEvent,z=parseInt(y.delay),g='[href*="',f='"]',k=g+r+f,e,b,s,d,v="href",m=y.eventCategory.toString().length>0?y.eventCategory.toString():"External",h="Click",u="target",p="_trackEvent",o="_trackPageview";var l=function(B){var i=B.toString().replace(/\s*/g,"").replace(/^(.{1})/,g+"$1").replace(/,/g,f+","+g).replace(/(.{1})$/,"$1"+f);return i};var x=(function(){var C=document.createElement("div"),B="Khtml Webkit".split(" "),i=B.length;return function(D){if(D in C.style){return true}D=D.replace(/^[a-z]/,function(E){return E.toUpperCase()});while(i--){if(B[i]+D in C.style){return true}}return false}})();if(!x("appearance")){z=0}if(y.trackCrossDomain&&q.length>0){for(var t=0;t<q.length;t++){e=new RegExp(q[t],"g");if(e.test(r)){break}}q.splice(t,1);q=l(q);b=this.filter(q).not(k).each(function(){a(this).click(function(){_gaq.push(["_link",a(this).attr(v)]);return false})})}if(y.trackFiles&&j.length>0){j=l(j);A=true}s=this.filter('[href^="http"]').not(k).not(b);if(A&&n){s=s.add(j).filter(this)}s.each(function(){a(this).click(function(){var B=a(this).attr(v);_gaq.push([p,m,h,B]);if(y.trackAlternatePropertyIDs&&w.length>0){for(var C=0;C<w.length;C++){_gaq.push([""+w[C]+"."+p,m,h,B])}}if((!a(this).attr(u)||a(this).attr(u).toLowerCase()!="_blank")&&z>0){setTimeout(function(){window.location.href=B},z);return false}})});var d=this.not(b).not(s).not(k).not('[href^="/"]').not('[href^="../"]');if(A&&!n){d=d.add(j).filter(this)}d.each(function(){a(this).click(function(){var B=a(this).attr(v);_gaq.push([o,B]);if(y.trackAlternatePropertyIDs&&w.length>0){for(var C=0;C<w.length;C++){_gaq.push([""+w[C]+"."+o,B])}}if(z>0){setTimeout(function(){window.location.href=B},z);return false}})});return this}})(jQuery);